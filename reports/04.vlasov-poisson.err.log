Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
%%fortran --f90flags "-fopenmp" --extra "-lgomp" --link fftw3

module bsl_fftw

    use, intrinsic :: iso_c_binding
    implicit none
    include 'fftw3.f03'
    
    contains
    
   
    recursive function bspline(p, j, x) result(res)
    
        integer :: p, j
        real(8) :: x, w, w1
        real(8) :: res
     
        if (p == 0) then
            if (j == 0) then
                res = 1.0
                return
            else
                res = 0.0
                return
            end if
        else
            w = (x - j) / p
            w1 = (x - j - 1) / p
        end if
     
        res = w * bspline(p-1,j,x)+(1-w1)*bspline(p-1,j+1,x)
    
    end function bspline
   
    subroutine advection(p, n, delta, alpha, axis, df)
    
        integer, intent(in)     :: p
        integer, intent(in)     :: n
        real(8), intent(in)     :: delta
        real(8), intent(in)     :: alpha(0:n-1)
        integer, intent(in)     :: axis
        real(8), intent(inout)  :: df(0:n-1,0:n-1)
              
        !f2py optional , depend(in) :: n=shape(df,0)
     
        real(8),    allocatable :: f(:)
        complex(8), allocatable :: ft(:)
        real(8),    allocatable :: eig_bspl(:)
        real(8),    allocatable :: modes(:)
        complex(8), allocatable :: eigalpha(:)
        integer(8)              :: fwd
        integer(8)              :: bwd
     
        integer                 :: i
        integer                 :: j
        integer                 :: ishift
        real(8)                 :: beta
        real(8)                 :: pi 
              
        pi = 4.0_8 * atan(1.0_8)
    
        allocate(modes(0:n/2))
        allocate(eigalpha(0:n/2))
        allocate(eig_bspl(0:n/2))
        allocate(f(0:n-1))
        allocate(ft(0:n/2))
     
        do i = 0, n/2
           modes(i) = 2.0_8 * pi * i / n
        end do
      
        call dfftw_plan_dft_r2c_1d(fwd, n, f, ft, FFTW_ESTIMATE)
        call dfftw_plan_dft_c2r_1d(bwd, n, ft, f, FFTW_ESTIMATE)
     
        eig_bspl = 0.0   
        do j = 1, (p+1)/2
           eig_bspl = eig_bspl + bspline(p, j-(p+1)/2, 0.0_8) * 2.0 * cos(j * modes)
        end do
     
        eig_bspl = eig_bspl + bspline(p, -(p+1)/2, 0.0_8)
      
        !$OMP PARALLEL DO DEFAULT(FIRSTPRIVATE), SHARED(df,fwd,bwd)
        do i = 0, n-1
     
            ishift = floor(-alpha(i) / delta)
            beta   = -ishift - alpha(i) / delta
            eigalpha = (0.0_8, 0.0_8)
          
            do j=-(p-1)/2, (p+1)/2+1
               eigalpha = eigalpha + bspline(p, j-(p+1)/2, beta) * exp((ishift+j) * (0.0_8,1.0_8) * modes)
            end do     
            
            if (axis == 0) then
              f = df(:,i)
            else
              f = df(i,:)
            end if
   
            call dfftw_execute_dft_r2c(fwd, f, ft)
            ft = ft * eigalpha / eig_bspl / n
            call dfftw_execute_dft_c2r(bwd, ft, f)
           
            if (axis == 0) then
              df(:,i) = f
            else
              df(i,:) = f
            end if
  
        end do
        !$OMP END PARALLEL DO     
        
        call dfftw_destroy_plan(fwd)
        call dfftw_destroy_plan(bwd)
        deallocate(modes)
        deallocate(eigalpha)
        deallocate(eig_bspl)
        deallocate(f)
        deallocate(ft)
    
    end subroutine advection


end module bsl_fftw
------------------

----- stderr -----
/home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90:6: Error: Can't open included file 'fftw3.f03'
error: Command "/usr/bin/gfortran -fopenmp -fPIC -O3 -funroll-loops -I/tmp/tmpc3g2kbix/src.linux-x86_64-3.8 -I/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/numpy/core/include -I/opt/hostedtoolcache/Python/3.8.18/x64/include/python3.8 -c -c /home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90 -o /tmp/tmpc3g2kbix/home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.o -J/tmp/tmpc3g2kbix/ -I/tmp/tmpc3g2kbix/" failed with exit status 1
----- stdout -----
No 'fftw3' resources found in system (try `f2py --help-link`)
running build
running config_cc
INFO: unifing config_cc, config, build_clib, build_ext, build commands --compiler options
running config_fc
INFO: unifing config_fc, config, build_clib, build_ext, build commands --fcompiler options
running build_src
INFO: build_src
INFO: building extension "_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b" sources
INFO: f2py options: []
INFO: f2py:> /tmp/tmpc3g2kbix/src.linux-x86_64-3.8/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16bmodule.c
creating /tmp/tmpc3g2kbix/src.linux-x86_64-3.8
Reading fortran codes...
	Reading file '/home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90' (format:free)
{'before': '', 'this': 'use', 'after': ', intrinsic :: iso_c_binding '}
Line #4 in /home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90:"    use, intrinsic :: iso_c_binding "
	analyzeline: Could not crack the use statement.
Line #7 in /home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90:"    include 'fftw3.f03' "
	readfortrancode: could not find include file 'fftw3.f03' in /home/runner/.cache/ipython/fortranmagic/c7a0ea26. Ignoring.
Line #44 in /home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90:"              optional , depend(in) :: n=shape(df,0)"
	analyzeline: cannot handle multiple attributes without type specification. Ignoring ' depend(in)'.
Post-processing...
	Block: _fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b
			Block: bsl_fftw
				Block: bspline
In: :_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b:/home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90:bsl_fftw:bspline
analyzevars: prefix ('recursive') were not used
				Block: advection
Applying post-processing hooks...
  character_backward_compatibility_hook
Post-processing (stage 2)...
	Block: _fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b
		Block: unknown_interface
			Block: bsl_fftw
				Block: bspline
				Block: advection
Building modules...
    Building module "_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b"...
		Constructing F90 module support for "bsl_fftw"...
		Creating wrapper for Fortran function "bspline"("bspline")...
            Constructing wrapper function "bsl_fftw.bspline"...
              res = bspline(p,j,x)
            Constructing wrapper function "bsl_fftw.advection"...
              advection(p,delta,alpha,axis,df,[n])
    Wrote C/API module "_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b" to file "/tmp/tmpc3g2kbix/src.linux-x86_64-3.8/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16bmodule.c"
    Fortran 90 wrappers are saved to "/tmp/tmpc3g2kbix/src.linux-x86_64-3.8/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b-f2pywrappers2.f90"
INFO:   adding '/tmp/tmpc3g2kbix/src.linux-x86_64-3.8/fortranobject.c' to sources.
INFO:   adding '/tmp/tmpc3g2kbix/src.linux-x86_64-3.8' to include_dirs.
copying /opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/numpy/f2py/src/fortranobject.c -> /tmp/tmpc3g2kbix/src.linux-x86_64-3.8
copying /opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/numpy/f2py/src/fortranobject.h -> /tmp/tmpc3g2kbix/src.linux-x86_64-3.8
INFO:   adding '/tmp/tmpc3g2kbix/src.linux-x86_64-3.8/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b-f2pywrappers2.f90' to sources.
INFO: build_src: building npy-pkg config files
running build_ext
INFO: customize UnixCCompiler
INFO: customize UnixCCompiler using build_ext
INFO: get_default_fcompiler: matching types: '['arm', 'gnu95', 'intel', 'lahey', 'pg', 'nv', 'absoft', 'nag', 'vast', 'compaq', 'intele', 'intelem', 'gnu', 'g95', 'pathf95', 'nagfor', 'fujitsu']'
INFO: customize ArmFlangCompiler
WARN: Could not locate executable armflang
INFO: customize Gnu95FCompiler
INFO: Found executable /usr/bin/gfortran
INFO: customize Gnu95FCompiler
INFO: customize Gnu95FCompiler using build_ext
INFO: building '_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b' extension
INFO: compiling C sources
INFO: C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC

creating /tmp/tmpc3g2kbix/tmp
creating /tmp/tmpc3g2kbix/tmp/tmpc3g2kbix
creating /tmp/tmpc3g2kbix/tmp/tmpc3g2kbix/src.linux-x86_64-3.8
INFO: compile options: '-DNPY_DISABLE_OPTIMIZATION=1 -I/tmp/tmpc3g2kbix/src.linux-x86_64-3.8 -I/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/numpy/core/include -I/opt/hostedtoolcache/Python/3.8.18/x64/include/python3.8 -c'
INFO: gcc: /tmp/tmpc3g2kbix/src.linux-x86_64-3.8/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16bmodule.c
INFO: gcc: /tmp/tmpc3g2kbix/src.linux-x86_64-3.8/fortranobject.c
INFO: compiling Fortran 90 module sources
INFO: Fortran f77 compiler: /usr/bin/gfortran -Wall -g -ffixed-form -fno-second-underscore -fPIC -O3 -funroll-loops
Fortran f90 compiler: /usr/bin/gfortran -fopenmp -fPIC -O3 -funroll-loops
Fortran fix compiler: /usr/bin/gfortran -Wall -g -ffixed-form -fno-second-underscore -fopenmp -fPIC -O3 -funroll-loops
creating /tmp/tmpc3g2kbix/home
creating /tmp/tmpc3g2kbix/home/runner
creating /tmp/tmpc3g2kbix/home/runner/.cache
creating /tmp/tmpc3g2kbix/home/runner/.cache/ipython
creating /tmp/tmpc3g2kbix/home/runner/.cache/ipython/fortranmagic
creating /tmp/tmpc3g2kbix/home/runner/.cache/ipython/fortranmagic/c7a0ea26
INFO: compile options: '-I/tmp/tmpc3g2kbix/src.linux-x86_64-3.8 -I/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/numpy/core/include -I/opt/hostedtoolcache/Python/3.8.18/x64/include/python3.8 -c'
extra options: '-J/tmp/tmpc3g2kbix/ -I/tmp/tmpc3g2kbix/'
INFO: gfortran:f90: /home/runner/.cache/ipython/fortranmagic/c7a0ea26/_fortran_magic_6f68e1bb7cc3336a4a1a84ab7df8b16b.f90
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[25], line 1[0m
[0;32m----> 1[0m [43mget_ipython[49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mrun_cell_magic[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mfortran[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43m--f90flags [39;49m[38;5;124;43m"[39;49m[38;5;124;43m-fopenmp[39;49m[38;5;124;43m"[39;49m[38;5;124;43m --extra [39;49m[38;5;124;43m"[39;49m[38;5;124;43m-lgomp[39;49m[38;5;124;43m"[39;49m[38;5;124;43m --link fftw3[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43mmodule bsl_fftw[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    use, intrinsic :: iso_c_binding[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    implicit none[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    include [39;49m[38;5;124;43m'[39;49m[38;5;124;43mfftw3.f03[39;49m[38;5;124;43m'[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    contains[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m   [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    recursive function bspline(p, j, x) result(res)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer :: p, j[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8) :: x, w, w1[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8) :: res[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        if (p == 0) then[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            if (j == 0) then[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m                res = 1.0[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m                return[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            else[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m                res = 0.0[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m                return[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            end if[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        else[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            w = (x - j) / p[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            w1 = (x - j - 1) / p[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        end if[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        res = w * bspline(p-1,j,x)+(1-w1)*bspline(p-1,j+1,x)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    end function bspline[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m   [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    subroutine advection(p, n, delta, alpha, axis, df)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer, intent(in)     :: p[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer, intent(in)     :: n[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8), intent(in)     :: delta[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8), intent(in)     :: alpha(0:n-1)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer, intent(in)     :: axis[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8), intent(inout)  :: df(0:n-1,0:n-1)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m              [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        !f2py optional , depend(in) :: n=shape(df,0)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8),    allocatable :: f(:)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        complex(8), allocatable :: ft(:)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8),    allocatable :: eig_bspl(:)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8),    allocatable :: modes(:)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        complex(8), allocatable :: eigalpha(:)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer(8)              :: fwd[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer(8)              :: bwd[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer                 :: i[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer                 :: j[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        integer                 :: ishift[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8)                 :: beta[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        real(8)                 :: pi [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m              [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        pi = 4.0_8 * atan(1.0_8)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        allocate(modes(0:n/2))[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        allocate(eigalpha(0:n/2))[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        allocate(eig_bspl(0:n/2))[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        allocate(f(0:n-1))[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        allocate(ft(0:n/2))[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        do i = 0, n/2[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m           modes(i) = 2.0_8 * pi * i / n[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        end do[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m      [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        call dfftw_plan_dft_r2c_1d(fwd, n, f, ft, FFTW_ESTIMATE)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        call dfftw_plan_dft_c2r_1d(bwd, n, ft, f, FFTW_ESTIMATE)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        eig_bspl = 0.0   [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        do j = 1, (p+1)/2[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m           eig_bspl = eig_bspl + bspline(p, j-(p+1)/2, 0.0_8) * 2.0 * cos(j * modes)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        end do[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        eig_bspl = eig_bspl + bspline(p, -(p+1)/2, 0.0_8)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m      [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        !$OMP PARALLEL DO DEFAULT(FIRSTPRIVATE), SHARED(df,fwd,bwd)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        do i = 0, n-1[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            ishift = floor(-alpha(i) / delta)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            beta   = -ishift - alpha(i) / delta[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            eigalpha = (0.0_8, 0.0_8)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m          [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            do j=-(p-1)/2, (p+1)/2+1[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m               eigalpha = eigalpha + bspline(p, j-(p+1)/2, beta) * exp((ishift+j) * (0.0_8,1.0_8) * modes)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            end do     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            if (axis == 0) then[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m              f = df(:,i)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            else[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m              f = df(i,:)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            end if[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m   [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            call dfftw_execute_dft_r2c(fwd, f, ft)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            ft = ft * eigalpha / eig_bspl / n[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            call dfftw_execute_dft_c2r(bwd, ft, f)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m           [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            if (axis == 0) then[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m              df(:,i) = f[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            else[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m              df(i,:) = f[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m            end if[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m  [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        end do[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        !$OMP END PARALLEL DO     [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        call dfftw_destroy_plan(fwd)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        call dfftw_destroy_plan(bwd)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        deallocate(modes)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        deallocate(eigalpha)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        deallocate(eig_bspl)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        deallocate(f)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m        deallocate(ft)[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    [39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m    end subroutine advection[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;130;43;01m\n[39;49;00m[38;5;130;43;01m\n[39;49;00m[38;5;124;43mend module bsl_fftw[39;49m[38;5;130;43;01m\n[39;49;00m[38;5;124;43m"[39;49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/IPython/core/interactiveshell.py:2478[0m, in [0;36mInteractiveShell.run_cell_magic[0;34m(self, magic_name, line, cell)[0m
[1;32m   2476[0m [38;5;28;01mwith[39;00m [38;5;28mself[39m[38;5;241m.[39mbuiltin_trap:
[1;32m   2477[0m     args [38;5;241m=[39m (magic_arg_s, cell)
[0;32m-> 2478[0m     result [38;5;241m=[39m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   2480[0m [38;5;66;03m# The code below prevents the output from being displayed[39;00m
[1;32m   2481[0m [38;5;66;03m# when using magics with decodator @output_can_be_silenced[39;00m
[1;32m   2482[0m [38;5;66;03m# when the last Python token in the expression is a ';'.[39;00m
[1;32m   2483[0m [38;5;28;01mif[39;00m [38;5;28mgetattr[39m(fn, magic[38;5;241m.[39mMAGIC_OUTPUT_CAN_BE_SILENCED, [38;5;28;01mFalse[39;00m):

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/fortranmagic.py:516[0m, in [0;36mFortranMagics.fortran[0;34m(self, line, cell)[0m
[1;32m    511[0m res [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_run_f2py(f2py_args [38;5;241m+[39m [[38;5;124m'[39m[38;5;124m-m[39m[38;5;124m'[39m, module_name, [38;5;124m'[39m[38;5;124m-c[39m[38;5;124m'[39m,
[1;32m    512[0m                                   f_f90_file],
[1;32m    513[0m                      verbosity[38;5;241m=[39margs[38;5;241m.[39mverbosity,
[1;32m    514[0m                      fflags[38;5;241m=[39mfflags)
[1;32m    515[0m [38;5;28;01mif[39;00m res [38;5;241m!=[39m [38;5;241m0[39m:
[0;32m--> 516[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m([38;5;124m"[39m[38;5;124mf2py failed, see output[39m[38;5;124m"[39m)
[1;32m    518[0m [38;5;28mself[39m[38;5;241m.[39m_code_cache[key] [38;5;241m=[39m module_name
[1;32m    519[0m module [38;5;241m=[39m _imp_load_dynamic(module_name, module_path)

[0;31mRuntimeError[0m: f2py failed, see output

